{"version":3,"sources":["../src/message-tracker.js"],"names":["keccak256","require","MessageTracker","constructor","messages","id","message","join","exists","protocol","msgRecord","undefined","push","isSent","sent","module","exports"],"mappings":";;AAAA,MAAM;AAACA,EAAAA;AAAD,IAAcC,OAAO,CAAC,kBAAD,CAA3B;;AAEA,MAAMC,cAAN,CAAqB;AACnBC,EAAAA,WAAW,GAAE;AACX,SAAKC,QAAL,GAAgB,EAAhB;AACD;;AAEDC,EAAAA,EAAE,CAACC,OAAD,EAAS;AACT;AACA,WAAON,SAAS,CAACM,OAAO,CAACC,IAAR,CAAa,EAAb,CAAD,CAAhB;AACD;;AAEDC,EAAAA,MAAM,CAACF,OAAD,EAAUG,QAAV,EAAmB;AACvB,UAAMC,SAAS,GAAG,KAAKN,QAAL,CAAc,KAAKC,EAAL,CAAQC,OAAR,CAAd,CAAlB;AAEA,QAAG,CAACG,QAAD,IAAa,CAACC,SAAjB,EAA4B,OAAO,KAAP;AAC5B,WAAOA,SAAS,CAACD,QAAD,CAAT,KAAwBE,SAA/B;AACD;;AAEDC,EAAAA,IAAI,CAACN,OAAD,EAAUG,QAAV,EAAmB;AACrB,UAAMJ,EAAE,GAAG,KAAKA,EAAL,CAAQC,OAAR,CAAX;AACA,QAAG,CAAC,KAAKF,QAAL,CAAcC,EAAd,CAAJ,EAAuB,KAAKD,QAAL,CAAcC,EAAd,IAAoB,EAApB;AACvB,SAAKD,QAAL,CAAcC,EAAd,EAAkBI,QAAlB,IAA8BH,OAAO,CAAC,CAAD,CAArC,CAHqB,CAGqB;;AAC1C,WAAOD,EAAP;AACD;;AAEDQ,EAAAA,MAAM,CAACP,OAAD,EAAS;AACb,UAAMD,EAAE,GAAG,KAAKA,EAAL,CAAQC,OAAR,CAAX;AACA,WAAO,KAAKF,QAAL,CAAcC,EAAd,EAAkBS,IAAzB;AACD;;AAEDA,EAAAA,IAAI,CAACR,OAAD,EAAS;AACX,UAAMD,EAAE,GAAG,KAAKA,EAAL,CAAQC,OAAR,CAAX;AACA,SAAKF,QAAL,CAAcC,EAAd,EAAkBS,IAAlB,GAAyB,IAAzB;AACD;;AAhCkB;;AAmCrBC,MAAM,CAACC,OAAP,GAAiBd,cAAjB","sourcesContent":["const {keccak256} = require(\"eth-lib/lib/hash\");\n\nclass MessageTracker {\n  constructor(){\n    this.messages = [];\n  }\n  \n  id(message){\n    // TODO: probably message id should be calculated once, when a message is received\n    return keccak256(message.join(''));\n  }\n\n  exists(message, protocol){\n    const msgRecord = this.messages[this.id(message)];\n\n    if(!protocol || !msgRecord) return false;\n    return msgRecord[protocol] !== undefined;\n  }\n\n  push(message, protocol){\n    const id = this.id(message);\n    if(!this.messages[id]) this.messages[id] = {};\n    this.messages[id][protocol] = message[1]; // TTL\n    return id;\n  }\n  \n  isSent(message){\n    const id = this.id(message);\n    return this.messages[id].sent;\n  }\n\n  sent(message){\n    const id = this.id(message);\n    this.messages[id].sent = true;\n  }\n}\n\nmodule.exports = MessageTracker;\n"],"file":"message-tracker.js"}